(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Issue_adopt/Issue_adopt"],{"66c5":function(e,t,n){"use strict";n.r(t);var a=n("7fbd"),o=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=o.a},"7fbd":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=l(n("8328")),o=l(n("a3dd")),i=l(n("25d9"));function l(e){return e&&e.__esModule?e:{default:e}}var s=wx.cloud.database(),c=s.collection("adopt"),r=function(){Promise.all([n.e("common/vendor"),n.e("components/lb-picker/index")]).then(function(){return resolve(n("c965"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/venus-form/v-form").then(function(){return resolve(n("b24d"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/robby-image-upload/robby-image-upload").then(function(){return resolve(n("d83b"))}.bind(null,n)).catch(n.oe)},u={data:function(){return{url:"",value2:"",peopleInfo:{peoplename:"",peoplephone:"",peoplewechat:"",disphone:!1},cattype:"",ifloading:!1,loadingText:"",label2:"选择所在城市",list1:o.default,imageData:[],catlist:"",citydata:"",detailLocation:"",tmpimgdata:[],formDefinition:{fields:[{label:"昵称",name:"name",type:"input",inputType:"text",password:!1,placeholder:"宠物昵称(限5个字)",disabled:!1,maxLength:5},{label:"年龄",name:"age",type:"input",inputType:"number",password:!1,placeholder:"请填写猫咪年龄",disabled:!1,maxLength:10},{label:"性别",name:"sex",type:"radio",options:[{label:"女孩",value:1},{label:"男孩",value:2}]},{label:"是否免费",name:"cost",type:"radio",options:[{label:"免费",value:1},{label:"收押金",value:2},{label:"收费",value:3}]},{label:"是否注射疫苗",name:"vaccine",type:"switch"},{label:"是否绝育",name:"sterilization",type:"switch"},{label:"是否驱虫",name:"expellingParasite",type:"switch"},{label:"TA的故事",name:"sorry",type:"input",inputType:"textarea",password:!1,placeholder:"请输入宠物描述、送养原因...",disabled:!1,maxLength:-1},{label:"领养条件",name:"condition",type:"checkbox",options:[{label:"仅限同城",value:1},{label:"按时打疫苗",value:2},{label:"同意适龄绝育",value:3},{label:"不得遗弃、转让、贩卖、繁殖、虐待",value:4},{label:"有防盗门，必须封网",value:5},{label:"接受领养前家访，领养后回访",value:6},{label:"家庭成员全员同意",value:7},{label:"工作稳定，有一定经济基础",value:8},{label:"文明养宠，科学喂养",value:9},{label:"签订领养协议",value:10}]}],showSubmitBtn:!1,showResetBtn:!1},catInfo:{name:"",age:"",sex:1,cost:1,vaccine:!1,sterilization:!1,expellingParasite:!1,sorry:"",condition:[]},formPeople:{fields:[{label:"姓名",name:"peoplename",type:"input",inputType:"text",password:!1,placeholder:"请输入您的姓名",disabled:!1,maxLength:5},{label:"手机号",name:"peoplephone",type:"input",inputType:"number",password:!1,placeholder:"请输入您的手机号",disabled:!1,maxLength:11},{label:"微信",name:"peoplewechat",type:"input",inputType:"text",password:!1,placeholder:"请输入您的微信",disabled:!1,maxLength:-1},{label:"是否显示电话号码",name:"disphone",type:"switch"}]},masterImg:"",msaterid:""}},components:{robbyImageUpload:p,VForm:d,LbPicker:r},onShow:function(){this.catlist=i.default.slice(1);var t=this;s.collection("user").where({_openid:e.getStorageSync("openid")}).get().then((function(e){console.log(e.data[0].avatarUrl),t.masterImg=e.data[0].avatarUrl,t.msaterid=e.data[0]._id}))},mounted:function(){},methods:{onChange:function(){},pushadopt:function(){var t=this;console.log(this.$refs.pushimg);var n=this.$refs.cat.data,a=this.$refs.people.data;console.log("img",this.tmpimgdata),console.log("type",this.cattype),console.log("cat",this.$refs.cat.data),console.log("people",this.$refs.people.data),console.log(this.value2),console.log(this.detailLocation),0==this.tmpimgdata.length?this.$refs["toast"].open({type:"warning",message:"请上传猫咪图片",position:"middle",icon:"warning"}):""==this.cattype?this.$refs["toast"].open({type:"warning",message:"请选择猫咪种类",position:"middle",icon:"warning"}):""==n.name||""==n.age||""==n.sorry?this.$refs["toast"].open({type:"warning",message:"请填写猫咪的信息",position:"middle",icon:"warning"}):(this.detailLocation=void 0==this.value2||""==this.value2)?this.$refs["toast"].open({type:"warning",message:"请填写位置信息",position:"middle",icon:"warning"}):""==a.peoplename||""==a.peoplephone||""==a.peoplewechat?this.$refs["toast"].open({type:"warning",message:"请填写送养人信息",position:"middle",icon:"warning"}):a.peoplephone.length<11?this.$refs["toast"].open({type:"warning",message:"请填写正确的手机号码",position:"middle",icon:"warning"}):(this.ifloading=!0,this.loadingText="发布中",console.log("tmpdata",this.tmpimgdata),c.add({data:{cost:n.cost,viewed:0,imgList:this.tmpimgdata,date:new Date,adoptLocation:this.value2,adoptdetailLocation:this.detailLocation,masterid:this.msaterid,masterImg:this.masterImg,masterName:a.peoplename,masterPhone:a.peoplephone,masterWechat:a.peoplewechat,disphone:a.disphone,petName:n.name,petAge:n.age,petType:this.cattype,sterilization:n.sterilization,vaccine:n.vaccine,expellingParasite:n.expellingParasite,condition:n.condition,petSex:n.sex,story:n.sorry,ifadopt:!1},success:function(n){t.ifloading=!1,t.$refs["toast"].open({type:"success",message:"发布成功",position:"middle",icon:"success"}),e.reLaunch({url:"../Adopt/Adopt"})},fail:function(e){t.ifloading=!1,t.$refs["toast"].open({type:"error",message:"发布失败",position:"middle",icon:"error"}),console.log(e)}}))},updateImg:function(e){var t=this;e.currentImages.forEach((function(e){wx.cloud.uploadFile({cloudPath:"adopt/"+(0,a.default)()+".png",filePath:e}).then((function(e){console.log("fileid",e),t.tmpimgdata.push(e.fileID)}))}))},deleteimg:function(e){console.log("delete",e);var t=this.tmpimgdata[e.imgindex];console.log(t);var n=[];n.push(t),this.tmpimgdata.splice(e.imgindex,1),wx.cloud.deleteFile({fileList:n}).then((function(e){console.log(e)}))},sexChange:function(e){this.sexindex=e.detail.value},handleSubmit:function(e){console.log(e)},handleTap:function(e){this.$refs[e].show()},handleChange:function(e){console.log("change::",e)},handleConfirm:function(e){if(console.log("confirm::",e),e){var t=e.dataset.name,n=e.item.map((function(e){return e.label})).join("-");t&&n&&(this[t]=n)}},handleCancel:function(e){console.log("cancel::",e)}}};t.default=u}).call(this,n("543d")["default"])},"91cc":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var a={robbyImageUpload:function(){return n.e("components/robby-image-upload/robby-image-upload").then(n.bind(null,"d83b"))},clFilterBar:function(){return Promise.all([n.e("common/vendor"),n.e("cl-uni/components/cl-filter-bar/cl-filter-bar")]).then(n.bind(null,"b16e"))},clFilterItem:function(){return Promise.all([n.e("common/vendor"),n.e("cl-uni/components/cl-filter-item/cl-filter-item")]).then(n.bind(null,"89c3"))},clTextarea:function(){return Promise.all([n.e("common/vendor"),n.e("cl-uni/components/cl-textarea/cl-textarea")]).then(n.bind(null,"6391"))},clLoadingMask:function(){return n.e("cl-uni/components/cl-loading-mask/cl-loading-mask").then(n.bind(null,"f1a3"))},clToast:function(){return Promise.all([n.e("common/vendor"),n.e("cl-uni/components/cl-toast/cl-toast")]).then(n.bind(null,"e69c"))}},o=function(){var e=this,t=e.$createElement;e._self._c},i=[]},ae23:function(e,t,n){"use strict";n.r(t);var a=n("91cc"),o=n("66c5");for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("e44b");var l,s=n("f0c5"),c=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"2f6f2518",null,!1,a["a"],l);t["default"]=c.exports},d6f5:function(e,t,n){},e44b:function(e,t,n){"use strict";var a=n("d6f5"),o=n.n(a);o.a},f71b:function(e,t,n){"use strict";(function(e){n("8df7");a(n("66fd"));var t=a(n("ae23"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])}},[["f71b","common/runtime","common/vendor"]]]);